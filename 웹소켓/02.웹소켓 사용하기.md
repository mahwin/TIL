# ğŸ“¡ Web Socket ê°ì²´ë¥¼ ì´ìš©í•´ì„œ í´ë¼ì´ì–¸íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‘ì„±í•˜ê¸°

ìƒì„±ì: ì •ìœ ì„
ìƒì„± ì¼ì‹œ: 2023ë…„ 11ì›” 14ì¼ ì˜¤í›„ 4:14

### `WebSocket ê°ì²´ ìƒì„±í•˜ê¸°`

- ê°ì²´ì—ì„œ ì„œë²„ì™€ handshake í›„ ì„œë¸Œ í”„ë¡œí† ì½œë¡œ ë°”ê¿”ì¤Œ.

```jsx
new WebSocket(param_1,param_2)
// param_1 í•„ìˆ˜ : ì›¹ ì„œë²„ì˜ url 
// ex) wss://www.algo-with-me.shop
//     ws(80), wss(443) 

// param_2 ì˜µì…˜ : ì„œë¸Œ í”„ë¡œí† ì½œì„ ì§€ì •í•  ë•Œ ì‚¬ìš©ë˜ëŠ” ë¬¸ìì—´ | ë¬¸ìì—´[]
//               ì—†ì„ ê²½ìš° ë¹ˆ ë¬¸ìì—´ì„ ë„£ì€ ê²ƒìœ¼ë¡œ ê°„ì£¼í•´ì„œ ì„œë¸Œ í”„ë¡œí† ì½œì´ ì—†ìŒ 
```

- open ì´ë²¤íŠ¸ ê°ì²´
    - ì›¹ ì†Œì¼“ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ë‚œ í›„ ì •ìƒì ìœ¼ë¡œ handshakeê°€ ì¼ì–´ë‚˜ë©´ â€˜openâ€™ ì´ë²¤íŠ¸ê°€ ë°œìƒí•œë‹¤.
    
    ```jsx
    myWebSocket.addEvent('open',(event)=>{
     // event í˜•íƒœëŠ” ì•„ë˜ì™€ ê°™ë‹¤.
    })
    
    {
       isTrusted: true,
    		bubbles: false,
    		cancelBubble: false,
    		...,
    		timeStamp: 106.09999996423721,
    		type: "open",
    }
    ```
    

### `ì—°ê²° ì—ëŸ¬`

- ë§Œì•½ ì—°ê²° ì‹œë„ ì¤‘ ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´, onerror í—¨ë“¤ëŸ¬ê°€ ì‹¤í–‰
    - ì—°ê²° ì‹œë„ ì¤‘ ì—ëŸ¬ë¼ë©´ â€˜errorâ€™ì´ë€ ì´ë¦„ì˜ ì´ë²¤íŠ¸ê°€ WebSocket ê°ì²´ì— ì „ë‹¬
    - ê·¸ë¡œ ì¸í•´ onerror í•¸ë“¤ëŸ¬ ì‹¤í–‰
    - ë¬¼ë¡  ì¢…ë£Œ ì´ë²¤íŠ¸ë„ ë°œìƒí•˜ê¸´ í•¨
- ì—°ê²° í›„ì— ì—°ê²°ì´ ì¢…ë£Œë˜ëŠ” ê²½ìš°ì—ëŠ” onclose í•¸ë“¤ëŸ¬ê°€ ì‹¤í–‰
    - ì¢…ë£Œ í•œë‹¤ë©´, CloseEvent ì´ë²¤íŠ¸ê°€ WebSocket ê°ì²´ë¡œ ì „ë‹¬
    - ê·¸ë¡œ ì¸í•´ onerror í•¸ë“¤ëŸ¬ê°€ ì‹¤í–‰

### `ì„œë²„ì— ë°ì´í„° ì „ì†¡í•˜ê¸°`

- ìƒì„±í•œ WebSocket ê°ì²´ì— sendë¥¼ í˜¸ì¶œí•˜ì—¬ ì„œë²„ë¡œ ë°ì´í„°ë¥¼ ì „ì†¡ê°€ëŠ¥.
- ë³´ë‚¼ ìˆ˜ ìˆëŠ” ë°ì´í„°ëŠ” string, blob, buffer ë°°ì—´

```jsx
myWebSocket.send('LGTM')
```

- ì£¼ì˜í•  ì ì€ ì—°ê²°ì´ ë¹„ë™ê¸° ì‘ì—…ì´ê¸° ë•Œë¬¸ì— ë°”ë¡œ sendë¥¼ í˜¸ì¶œí•  ê²½ìš° ì‹¤íŒ¨í•  ê°€ëŠ¥ì„±ì´ ìˆë‹¤ëŠ” ì .

### `ì„œë²„ë¡œë¶€í„° ë°ì´í„° ìˆ˜ì‹ í•˜ê¸°`

- WebSocketì€ event-driven APIì„
- ë©”ì‹œì§€ê°€ ìˆ˜ì‹ ë˜ë©´ message ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ê³ 
- onmessageë¡œ ì´ë²¤íŠ¸ë¥¼ í•¸ë“¤ë§ ê°€ëŠ¥í•˜ë‹¤.

```jsx
myWebSocket.onmessage = function (event) {
  console.log(event.data);
};

// ì™„ì „íˆ ê°™ìŒ.
myWebSocket.addEventListener("message",function (event) {
  console.log(event.data);
})
```

- message ì´ë²¤íŠ¸ ê°ì²´
    - ì„œë²„ê°€ send ë©”ì„œë“œë¡œ ë°ì´í„°ë¥¼ ë³´ë‚´ë©´ message Eventê°€ ë°œìƒí•œë‹¤.
    
    ```jsx
    MessageEvent 
    	
    {
    	isTrusted: true,
    	bubbles: false,
    	cancelBubble:false,
    	data: ì„œë²„ê°€ ì „ë‹¬í•œ ë°ì´í„° ,
    	...,
    	timeStamp: 3299.2999999523163
    	type: "message"
    }
    
    ```
    

### `ì—°ê²°ì„ ì¢…ë£Œí•˜ê¸°`

- ì›¹ ì†Œì¼“ ì‚¬ìš©ì„ ë§ˆì³¤ë‹¤ë©´ close() ë©”ì„œë“œë¥¼ í˜¸ì¶œí•œë‹¤

```jsx
myWebSocket.close();
```

- close ì´ë²¤íŠ¸ ê°ì²´
    - web ì†Œì¼“ì„ ì„œë²„ë‚˜ í´ë¼ì´ì–¸íŠ¸ê°€ ì¢…ë£Œí•˜ê²Œ ë˜ë©´ ë°œìƒí•˜ëŠ” ì´ë²¤íŠ¸
    
    ```jsx
    CloseEvent
    
    {
    	isTrusted: true,
    	bubbles: false,
    	cancelBubble: false
    	cancelable: false,
    	...,
      timeStamp: 1037,
    	type: "close",
    	wasClean: true
    }
    ```
    

### `webSocket ê°ì²´ ì¤‘ìš” í”„ë¡œí„í‹°`

- readyState
    
    
    | ê°’ | ìƒíƒœ | ì„¤ëª… |
    | --- | --- | --- |
    | 0 | CONNECTING | ì†Œì¼“ì´ ìƒì„±ëìœ¼ë‚˜ ì—°ê²°ì€ ì•„ì§ ê°œë°©ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. |
    | 1 | OPEN | ì—°ê²°ì´ ê°œë°©ë˜ì–´ í†µì‹ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. |
    | 2 | CLOSING | ì—°ê²°ì„ ë‹«ëŠ” ì¤‘ì…ë‹ˆë‹¤. |
    | 3 | CLOSED | ì—°ê²°ì´ ë‹«í˜”ê±°ë‚˜, ê°œë°©í•  ìˆ˜ ì—†ì—ˆìŠµë‹ˆë‹¤. |
    
    ```jsx
    {
    	readyState:1
    }
    ```
    
    - WebSocketì˜ í”„ë¡œí† íƒ€ì…ì—ì„œ
        - ì•„ë˜ì™€ ê°™ì€ ìƒíƒœ ê°’ í™•ì¸ ê°€ëŠ¥
        
        ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-11-14 á„‹á…©á„’á…® 7.36.21.png](%F0%9F%93%A1%20Web%20Socket%20%E1%84%80%E1%85%A2%E1%86%A8%E1%84%8E%E1%85%A6%E1%84%85%E1%85%B3%E1%86%AF%20%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A2%E1%84%89%E1%85%A5%20%E1%84%8F%E1%85%B3%E1%86%AF%E1%84%85%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%A5%E1%86%AB%E1%84%90%E1%85%B3%20%E1%84%8B%E1%85%A2%E1%84%91%E1%85%B3%E1%86%AF%20fa88557f9690429aae44c7a879f56737/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-11-14_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_7.36.21.png)
        
        - ì¡°í•©í•˜ë©´
        
        ```jsx
        		
        const ws = new WebSocket('url')
        // ì´ëŸ° ì‹ìœ¼ë¡œ ë‹«í˜”ì„ ë•Œ ì–´ë–»ê²Œ í•˜ë€ ë¶„ê¸°ì²˜ë¦¬ ê°€ëŠ¥
        if(ws.readyState === ws.CLOSED){}
        if(ws.readyState === ws.CLOSING){}
        ```
        

### ì°¸ê³ ë¬¸í—Œ

[https://developer.mozilla.org/ko/docs/Web/API/WebSockets_API/Writing_WebSocket_client_applications](https://developer.mozilla.org/ko/docs/Web/API/WebSockets_API/Writing_WebSocket_client_applications)

[https://websockets.spec.whatwg.org/#dom-websocket-onopen](https://websockets.spec.whatwg.org/#dom-websocket-onopen)