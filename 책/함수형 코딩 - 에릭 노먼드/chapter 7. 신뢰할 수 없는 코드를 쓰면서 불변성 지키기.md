## 레거시 코드와 불변성

레거시 코드를 함께 사용하면서 카피-온-라이트 원칙을 지킬 수 있는 방법이 있다. 이를 방어적 복사라고 한다.

바뀔 수도 있는 데이터가 신뢰할 수 없는 코드에서 안전지대로 들어올 때, 깊은 복사를 통해 데이터를 보고할 수 있다. 원본이 바뀌지 않도록 막아주기 때문에 방어적이라고 한다.

```tsx
let origin = {};

function fn() {
  const copy = deepCopy(origin);
  lecacyCode(copy);
  origin = deepCopy(copy);
}
```

## 방어적 복사 규칙

규칙 1. 데이터가 안전한 코드에서 나갈 때 복사하기

1. 불변성 데이터를 위한 깊은 복사본을 만든다.
2. 신뢰할 수 없는 코드로 복사본을 전달한다.

규칙 2. 안전한 코드로 데이터가 들어올 때 복사하기
