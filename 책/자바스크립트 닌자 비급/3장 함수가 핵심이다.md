# 함수가 핵심이다

자바스크립트는 함수형 언어라는 것을 얼마나 이해하느냐에 따라 철수나 영희가 작성한 자바스크립트 코드냐, 아니면 닌자가 작성한 자바스크립트 코드냐의 차이를 만들어낸다.

가장 중요한 점은 자바스크립트 함수가 일급이라는 의미이다. 이는 자바스크립트 함수가 객체와 같은 지위를 가지며, 일반적인 다른 자바스크립트 객체처럼 취급할 수 있다는 것이다.

## 3.1.1 자바스크립트의 함수형 언어 특징이 왜 중요한가?

자바스크립트는 함수가 실행의 기본 모듈 단위이기 때문에 중요하다.

우리가 작성하는 대부분의 코드는 함수 호출 결과에 따라 실행될 것이다.

`1급 객체로서의 함수`

- 리터럴로 생성될 수 있다.
- 변수, 배열의 요소, 다른 객체의 프로퍼티에 할당될 수 있다.
- 함수의 인자로 전달될 수 있다.
- 함수의 결과 값으로 반환될 수 있다.
- 동적으로 생성된 프로퍼티를 가질 수 있다.

이 외에도 함수라서 호출될 수 있다는 특별한 기능을 가지고 있다.

`브라우저 이벤트 루프`

그래픽 유저 인터페이스는 대부분 비슷한 방식으로 개발된다.

- 사용자 인터페이스를 설정한다.
- 이벤트가 발생하기를 기다리는 루프에 진입한다.
- 발생한 이벤트에 대한 핸들러를 호출한다.

프론트 개발자는 브라우저에서 발생할 수 있는 여러 이벤트에 대해 이벤트 핸들러를 설정해야 한다. 이벤트가 발생하면 이 이벤트는 이벤트 큐에 들어간다. 그리고 브라우저는 이벤트를 디스패치하며 해당 이벤트에 대해 설정된 모든 이벤트 핸들러를 호출한다.

이런 브라우저 이벤트들이 발생하는 시간은 딱히 정해진 것이 아니고 이벤트가 일어나는 순서 또한 예측할 수 없다 따라서 브라우저가 이벤트를 처리하고 이벤트 핸들러 함수를 호출하는 과정은 '비동기' 방식이라 말할 수 있다. 브라우저에서 발생하는 이벤트는 다음과 같다.

- 브라우저 이벤트.
  - 페이지 로드를 완료했을 때나 페이지가 언로드 될 때 발생하는 이벤트 등.
- 네트워크 이벤트.
  - Ajax 요청에 대한 응답 이벤트 등.
- 사용자 이벤트.
  - 마우스 클릭, 마우스 움직임 또는 키 눌림 등.
- 타이머 이벤트.
  - 시간 제한이 만료되거나 주기적으로 발생하는 이벤트 등.

`콜백 함수`

콜백이라는 용어는 프로그램이 실행되는 동안 어떤 함수가 적절한 시점에서 다시 호출된다는 데서 생겨났다.

### 3.1.2 비교자를 사용하여 정렬하기

자바스크립트의 정렬은 배열 자체의 메서드를 통해 정렬 기능을 제공한다.

자바스크립트 언어의 가장 중요한 기능 가운데 하나는, 표현식을 사용할 수 있는 곳이라면 어디에서든 함수를 만들 수 있다는 것이다. 이를 통해, 어떤 함수를 그 함수가 사용되는 곳 근처에서 선언하고 불필요한 함수 이름을 제거함으로써 코드를 보다 짧고 이해하기 쉽도록 할 수 있다. 뿐만 아니라, 어떤 함수를 한 곳에서만 참조하는 경우라면 함수 일므이 굳이 필요하지 않고, 불필요한 함수 이름을 제거함으로써 전역 네임스페이스를 어지럽히는 것을 막을 수 있다.

## 3.2 함수 선언

자바스크립트 함수는 함수 리터럴을 사용하여 정의하는데, 숫자 리터럴이 숫자 값을 만들어내는 것과 마찬가지다.

함수 리터럴의 구조

1. function 키워드
2. 함수 이름.
   - 생략 가능.
3. 쉼표로 구분된 매개변수 목록과 그 매개변수 목록을 둘러싸고 있는 괄호.
4. 함수 본문. 중괄호로 둘러 싸여 있는 일련의 자바슼릡트 구문이다.

### 3.2.1 유효 범위와 함수

함수를 선언할 때, 그 함수가 속한 유효 범위와 그 함수 자체가 '만들어 내는' 유효 범위가 그 함수 내의 선언들에 어떤 영향을 주는지 신경 써야 한다.

## 3.3 호출

함수가 호출되는 방식은 코드 작동 방식에 큰 영향을 미친다. 특히 this 매개변수가 어떻게 바인딩 되는지를 결정한다. 함수를 실행하는 데에는 네 가지 다른 방법이 있다.

1. 함수로 호출.
2. 메서드로 호출.
3. 생성자로 호출,
4. 함수의 apply()나 call() 메서드로 호출.

### 3.3.1 인자(argument)에서 함수의 매개변수(parameter)까지

함수를 호출할 때 인자 목적을 제공하면, 이 인자들은 함수를 정의할 때 지정한 매개변수에 각 매개변수의 순서대로 할당된다.

모든 함수 호출에는 암묵적으로 arguments와 this 두 매개변수가 넘어온다.

`ARGUMENTS 매개변수`

arguments 매개변수는 함수에 전달된 모든 인자들을 담고 있는 컬렉션이다. 이 컬렉션은 인자 개수를 나타내는 length 프로퍼티를 가지고 고, 배열 인덱스 표기법을 사용하여 개별 인자 값을 얻을 수 있다.

그러나 arguments는 배열이 아니라 배열과 유사한 객체이다. arguments 객체는 배열처럼 인덱스를 사용하여 요소에 접근할 수 있지만, 배열의 메서드를 사용할 수는 없다.

`THIS 매개변수`

this 매개변수는 암묵적으로 함수 호출과 관계된 객체를 참조하며, 이를 '함수 컨텍스트'라고 한다. 자바스크립트에서 this binding은 함수를 어떻게 정의 했냐가 아니라 어떻게 호출할 것인가와 관련이 있다.

### 3.3.2 함수로 호출

() 연사자를 사용하여 함수를 호출하는 것을 의미한다. 이 상태에서의 this는 전역 컨텍스트이다.

### 3.3.3 메서드로 호출

함수를 객체의 프로퍼티로 할당하고, 그 프로퍼티를 사용하여 참조에 의한 호출을 하는 것을 메서드 호출이라고 한다.

### 3.3.4 생성자로 호출

생성자로 호출하면 생성한 인스턴스가 this가 된다.

`생성자의 강력함`

생성자로 함수를 호출하는 것은 자바스크립트만의 강력한 기능인데, 생성자가 호출되면 다음과 같은 특별한 행동이 일어난다.

1. 빈 객체가 생성된다.
2. 새로 생성된 객체는 this 매개변수로 생성자 함수에 전달된다.
3. 어떤 명시적인 반환 값이 없다면, 새로 생성된 객체가 생성자의 값으로 반환된다.

`생성자 함수의 주의할 점`

생성자 함수를 new 키워드 없이 호출하면 전역 객체에 영향을 줄 수 있다. 이를 방지하기 위해 생성자 함수는 대문자로 시작하는 것이 관례이다.

### 3.3.5 apply() 메서드와 call() 메서드로 호출

this를 명시적으로 설정하고 싶으면 call이나 apply 메서드를 사용한다.

## 3.4 정리

자바스크립트 함수의 동작과 관련된 여러 가지 흥미로운 면들을 살펴보았다.

- 자바스크립트가 함수형 언어라는 사실을 깨달아야 세련된 코드를 작성할 수 있다.
- 자바스크립트의 다른 모든 객체와 마찬가지로 함수는 일급 객체이다.
  - 리터럴로 생성할 수 있다.
  - 변수나 프로퍼티에 할당할 수 있다.
  - 매개변수로 전달할 수 있다.
  - 함수의 결과로 반환할 수 있다.
  - 프로퍼티와 메서드를 가질 수 있다.
- 모든 객체는 다른 객체와 그 객체를 '강력히' 구분 짓는 것이 있다. 함수와 다른 객체와의 큰 차이는 호출할 수 있느냐는 것이다.
- 함수는 리터럴로 생성하며 이때 함수 이름은 생략할 수 있다.
- 브라우저는 페이지가 로드되고 언로드 되기 전까지의 페이지 생명 주기 동안, 여러 형식의 이벤트에 대한 이벤트 핸들러를 호출하는데, 이 이벤트 핸들러를 호출하는 것이 곧 함수를 호출하는 것이다.
- 함수 내에서 선언된 타입의 유효 범위는 대부분의 다른 언어와 다르다.
  - 함수 내에 선언된 변수의 유효 범위는 변수가 선언된 지점으로부터 함수의 끝까지다.
  - 이름이 지정된 내부 함수는 함수 내의 모든 곳에서 유요하다.
- 함수의 매개변수 목록의 길이와 실제 전달된 인자 목록의 길이는 서로 다를 수 있다.
  - 할당되지 않은 매개변수는 undefined로 설정된다.
  - 추가 인자들은 매개변수와 연결되지 않는다.
- 함수를 호출하면 암묵적으로 두 개의 매개변수가 전달된다.
  - arguments
  - this
- 함수가 호출하는 방식은 여러 가지이고, 각 호출 메커니즘에 따라 함수 콘텍스트 값이 결정된다.
  - 메서드로 호출되면 그 메서드를 소유한 객체이다.
  - 생성자로 호출되면 새로 생성된 객체이다.
  - apply()나 call() 메서드로 호출되면 지정된 객체이다.
