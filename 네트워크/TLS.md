### 암호화

암호화는 승인된 당사자만 정보를 이해할 수 있도록 데이터를 `스크램블`한 방법이다. 스크램블 전 상태로 돌리기 위해서는 당사자간에 동의한 `키`가 필요하다.

### 암호화의 종류

`대칭키 암호화` : 암호화와 복호화에 같은 키를 사용하는 방식

`비대칭키 암호화` : 암호화와 복호화에 다른 키를 사용하는 방식

비대칭키 암호화가 보완적으로 좋지만, 암호화와 복호화에 많은 CPU 연산이 필요하다.

### 대칭키 암호화

당사자가 동일한 키를 가지고 있어야 한다. 동일한 키로 암호화와 복호화를 수행한다.

### 비대칭키 암호화

개인키와 공개키를 사용하는 방식이다. 공개키를 이용해 데이터를 암호화하고, 개인키로 데이터를 복호화한다. 개인키는 당사자만 가지고 있어야 한다.

### TLS

SSL으로도 불린다. `Transport Layer Security`의 약자로, 인터넷 상에서 데이터를 안전하게 전송하기 위한 통신 규약이다. 제 3자가 메시지를 도청하거나 변조하지 못하도록 한다.

### TLS의 동작

1. Client Hello

클라이언트는 서버에게 TLS 버전, 사이퍼슈트, 클라이언트 랜덤값, 임시 DH 매개변수를 서버에 보낸다.

2. Server Hello
   서버는 클라이언트로 받은 옵션을 확인하고, 적절한 대답을 한다.
   사용할 수 있는 TLS 버전, 사이퍼 슈트 지원 여부, 서버 랜덤값, 임시 DH 매개변수, 공개키가 포함된 `SSL 인증서`를 보낸다.

3. Finished
   클라이언트와 서버가 세션키를 기반으로 대칭 암호화된 통신이 시작된다.

### `DH 매개변수`

DH 매개변수는 Diffe-Hellman 알고리즘으로 세션 키를 만드는 과정에서 필요한 매개변수이다.

<img width="355" alt="스크린샷 2024-04-18 오전 11 50 17" src="https://gist.github.com/assets/78193416/95e0222f-cdb9-486f-b87e-59a6f28bd775">

### `사이퍼슈트`

사이퍼슈트는 프로토콜, AEAD 사이퍼 모드, 해싱 알고리즘이 나열된 규약을 말하며 암호제품군을 의미한다.

### `SSL 인증서`

SSL인증서는 클라이언트와 서버간의 통신을 제 3자가 보증하는 전자문서이다. 인증서에는 두 가지가 포함된다.

1. 서비스의 정보 (인증서를 발급한 CA, 서비스의 도메인)
2. 서버 측 공개키 (공개키의 내용, 공개키의 암호화 방법)

`1을 이용해서 서버의 신원을 확인한다.`

브라우저가 인증서를 받았을 때, 브라우저의 CA 리스트를 확인하고 일치하는 CA가 있다면 해당 공개키를 이용해서 복호화한다. 복호화에 성공한다면 해당 인증서는 분명히 공인된 CA에 의해 암호화된 데이터이다. 이를 통해 서버의 신원을 확인할 수 있다.

`2을 이용해서 세션키를 암호화한다.`
클라이언트와 서버는 DH 매개변수를 이용해서 세션키를 만들고, 이 세션키를 서버의 공개키로 암호화해서 서버에게 보낸다. 서버는 이 세션키를 개인키로 복호화해서 세션키를 얻는다. 이때 세션키를 암호화하는 키로 인증서의 서버 측 공개키가 사용된다.

세션키가 생성된 후에는 미리 만들어 놓은 세션키를 기반으로 연결을 생성하기 때문에 이 때 인증에 드는 비용이 없기 때문에 0 - RTT라는 특징이 있다.
