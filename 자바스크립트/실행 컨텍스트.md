# 실행 컨텍스트

### 실행 컨텍스트(execution context)

- 실행할 코드에 제공할 환경 정보들을 모아놓은 객체

### js 엔진은 실행할 함수를 실행 컨텍스트와 함께 콜 스택에 쌓는다.

- 가장 위에 있는 실행 컨텍스트만 활성화됨.

![%E1%84%89%E1%85%B5%E1%86%AF%E1%84%92%E1%85%A2%E1%86%BC%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%86%A8%E1%84%89%E1%85%B3%E1%84%90%E1%85%B3](https://gist.github.com/assets/78193416/1b943460-a8e1-47ed-85ef-fa0002c44c7a)

### 호이스팅

선언문이 마치 최상단에 끌어올려진 듯한 현상

- js 엔진이 전체 코드를 읽으면서 변수 등을 실행 컨텍스트에 기록해 두기 때문.
- 정확히는 `Environment Record`(환경 레코드)라고 부름
  - 식별자와 식별자에 바인딩된 값을 기록
- 선언문이 있는 코드라인을 최상단으로 끌어올린 것은 아님.

### JS 엔진의 코드 실행과정

생성 단계

- Execution Context 생성
- 선언문만 실행해서 환경 레코드에 기록

실행 단계

- 선언문 외 나머지 코드 순차적 실행
- 환경 레코드 참조하거나 업데이트

아래 코드를 기준으로 확인해보자

```jsx
console.log(num); // => undefined
var num = "123";
console.log(num); // => 123
```

`생성 단계`

1. 전역 실행 컨텍스트를 생성해서 callStack에 넣는다
2. 전체 코드를 읽으며 선언할 게 있는지 확인 후 있다면, 선언한다.
   1. 환경 레코드에 선언한 내용을 기록한다.
   2. var로 선언된 num 변수가 호이스팅 되고,
      {num:undefined}가 환경 레코드에 저장된다.

`실행 단계`

1. console.log(num)이 실행된다.
2. console.log라는 함수가 실행되기 때문에, 함수의 실행 컨텍스트가 생긴다.
3. num을 해당 실행 컨텍스트에서 찾지만 없고, 스코프 체이닝을 통해 한 단계 위의 실행 컨텍스트에서 찾아 undefined를 콘솔에 찍는다.
4. var num = "123"; 라인이 실행되고, {num:undefined}가 {num:”123”}으로 업데이트 된다.

### 변수 호이스팅 (Environment Record)

- `var`
  - 선언문만 실행해서 Environment Record에 기록함.
  - var의 경우 선언과 초기화가 동시에 일어남
    - 선언 ⇒ 메모리 공간 확보
      - { 변수명 }
    - 초기화 ⇒ 암묵적으로 undefined 값 바인딩
      - { 변수명 : undefined }
  - 그 이후에 코드를 순차적으로 해석하다가 해당 변수를 만나면 참조하거나 업데이트 한다.
    - { 변수명 : 업데이트 }
- `let` , `const`
  - 선언만 일어나고 초기화가 일어나지 않음
  - { 변수명 }에서 멈추기 때문에 선언 코드 이전에 사용하려면 참조 에러가 생긴다.

### 함수 호이스팅

- `함수 표현식`
  - 함수 표현식은 함수를 변수에 담는 행위
  - 변수 호이스팅과 일치한다.
- `함수 선언식`
  - 완성된 형태로 실행 컨텍스트에 저장함
  - 선언 전에도 함수를 사용할 수 있다.
  - {myFun: f {} }

### 스코프 체이닝 (Environment Reference)

식별자를 결정할 때 활요하는 스코프들의 연결리스트

- 식별자 결정
  - 변수나 함수의 값을 결정하는 것
  - js는 콜스택에 쌓여있는 실행 컨텍스트를 기준으로 값을 찾아낸다.
  - 현재 실행 컨텍스트에 없을 경우 밖 렉시컬 환경에서 값을 찾아낸다.
  - 전역 실행 렉시컬 환경에서도 발견할 수 없다면 Error를 발생 시킨다.

### 실행 컨텍스트

- 코드를 실행하는데 필요한 환경을 제공하는 객체
- 식별자 결정을 더욱 효율적으로 하기 위한 수단

참고문헌

[https://www.youtube.com/watch?v=EWfujNzSUmw](https://www.youtube.com/watch?v=EWfujNzSUmw)
